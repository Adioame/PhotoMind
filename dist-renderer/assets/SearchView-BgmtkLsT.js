import{d as R,u as j,c as v,a as s,e as a,w as o,m as z,F,l as E,t as u,k as g,n as G,r as p,f as l,o as r,h as K,i as m,j as P,g as U}from"./index-b2OWAZnp.js";import{P as H}from"./PhotoGrid-CbLsguGP.js";import{S as L}from"./Search24Regular-N_JwTMUc.js";import{_ as Q}from"./_plugin-vue_export-helper-DZzl9uFm.js";const Y={class:"search-container"},Z={class:"search-header"},J={class:"search-box"},O={class:"search-suggestions"},W={key:0,class:"search-results"},X={class:"results-header"},ee={key:0,class:"search-time"},te={key:0,class:"no-results"},ae={key:1,class:"initial-state"},oe={key:0,class:"photo-preview"},se={class:"preview-image"},ne={class:"preview-info"},le=R({__name:"SearchView",setup(re){U();const S=j(),h=p(""),_=p(!1),d=p([]),y=p(0),b=p(!1),k=p(!1),t=p(null),$=["2015年的照片","日本旅游","儿子的照片","新疆合影","全家福"],C=()=>!!window.photoAPI,A=(i,e=10)=>{const f=[{name:"日本东京",lat:35.6762,lng:139.6503},{name:"新疆乌鲁木齐",lat:43.8256,lng:87.6168},{name:"北京",lat:39.9042,lng:116.4074}];return Array.from({length:e},(x,n)=>({id:n,uuid:`search-${n}`,fileName:`IMG_2015${String(n%12+1).padStart(2,"0")}${String(n%28+1).padStart(2,"0")}_${n}.jpg`,takenAt:`2015-${String(n%12+1).padStart(2,"0")}-${String(n%28+1).padStart(2,"0")}T10:30:00Z`,location:f[n%f.length]}))},q=async()=>{if(!h.value.trim()){S.warning("请输入搜索关键词");return}_.value=!0,b.value=!0,d.value=[];const i=performance.now();try{if(C()){const e=await window.photoAPI.photos.search(h.value);d.value=e.results||[]}else await new Promise(e=>setTimeout(e,800)),d.value=A(h.value,10);y.value=Math.round(performance.now()-i),d.value.length===0&&S.info("没有找到符合条件的照片")}catch(e){console.error("搜索失败:",e),S.error("搜索失败，请重试")}finally{_.value=!1}},N=i=>{t.value=i,k.value=!0},V=i=>{if(!i)return"-";const e=new Date(i);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`};return(i,e)=>{const f=l("n-icon"),x=l("n-input"),n=l("n-button"),M=l("n-tag"),T=l("n-empty"),D=l("n-image"),w=l("n-descriptions-item"),I=l("n-descriptions"),B=l("n-modal");return r(),v("div",Y,[s("div",Z,[e[3]||(e[3]=s("h1",null,"智能搜索",-1)),e[4]||(e[4]=s("p",{class:"subtitle"},"用自然语言描述你想找的照片",-1)),s("div",J,[a(x,{value:h.value,"onUpdate:value":e[0]||(e[0]=c=>h.value=c),placeholder:"例如：2015年日本旅游的照片、和儿子在新疆的合影...",size:"large",clearable:"",onKeyup:z(q,["enter"])},{prefix:o(()=>[a(f,{size:"20",color:"#5E6AD2"},{default:o(()=>[a(K(L))]),_:1})]),_:1},8,["value"]),a(n,{type:"primary",size:"large",onClick:q,loading:_.value},{default:o(()=>[...e[2]||(e[2]=[m(" 搜索 ",-1)])]),_:1},8,["loading"])]),s("div",O,[(r(),v(F,null,E($,c=>a(M,{key:c,round:"",clickable:"",onClick:ie=>{h.value=c,q()}},{default:o(()=>[m(u(c),1)]),_:2},1032,["onClick"])),64))])]),b.value?(r(),v("div",W,[s("div",X,[s("span",null,"找到 "+u(d.value.length)+" 张照片",1),y.value?(r(),v("span",ee,"耗时 "+u(y.value)+"ms",1)):g("",!0)]),a(H,{photos:d.value,loading:_.value,columns:4,onPhotoClick:N},null,8,["photos","loading"]),!_.value&&d.value.length===0?(r(),v("div",te,[a(T,{description:"没有找到符合条件的照片"},{extra:o(()=>[...e[5]||(e[5]=[s("p",null,"试试其他关键词",-1)])]),_:1})])):g("",!0)])):(r(),v("div",ae,[...e[6]||(e[6]=[G('<div class="search-tips" data-v-50a1a1d8><h3 data-v-50a1a1d8>搜索技巧</h3><ul data-v-50a1a1d8><li data-v-50a1a1d8><strong data-v-50a1a1d8>时间查询：</strong>&quot;2015年的照片&quot;、&quot;去年夏天的照片&quot;</li><li data-v-50a1a1d8><strong data-v-50a1a1d8>地点查询：</strong>&quot;日本旅游&quot;、&quot;新疆的照片&quot;、&quot;北京&quot;</li><li data-v-50a1a1d8><strong data-v-50a1a1d8>人物查询：</strong>&quot;儿子的照片&quot;、&quot;一家四口合影&quot;</li><li data-v-50a1a1d8><strong data-v-50a1a1d8>组合查询：</strong>&quot;2015年日本和儿子的合影&quot;</li></ul></div>',1)])])),a(B,{show:k.value,"onUpdate:show":e[1]||(e[1]=c=>k.value=c),preset:"card",style:{width:"90%","max-width":"900px"}},{header:o(()=>[...e[7]||(e[7]=[s("span",null,"照片详情",-1)])]),default:o(()=>[t.value?(r(),v("div",oe,[s("div",se,[a(D,{src:t.value.thumbnailPath||t.value.thumbnail_url,"preview-src":t.value.thumbnailPath||t.value.thumbnail_url,"object-fit":"contain",style:{width:"100%","max-height":"500px"}},null,8,["src","preview-src"])]),s("div",ne,[a(I,{column:1,"label-placement":"left"},{default:o(()=>[a(w,{label:"文件名"},{default:o(()=>[m(u(t.value.fileName),1)]),_:1}),a(w,{label:"拍摄时间"},{default:o(()=>[m(u(V(t.value.takenAt)),1)]),_:1}),t.value.location?.name?(r(),P(w,{key:0,label:"地点"},{default:o(()=>[m(u(t.value.location.name),1)]),_:1})):g("",!0),t.value.width?(r(),P(w,{key:1,label:"尺寸"},{default:o(()=>[m(u(t.value.width)+" x "+u(t.value.height),1)]),_:1})):g("",!0)]),_:1})])])):g("",!0)]),_:1},8,["show"])])}}}),pe=Q(le,[["__scopeId","data-v-50a1a1d8"]]);export{pe as default};
