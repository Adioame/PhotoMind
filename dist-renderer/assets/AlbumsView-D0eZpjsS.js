import{d as P,o as l,c as r,a as e,u as N,b as Y,e as t,F as f,w as a,i as z,k as w,r as C,f as p,h as d,l as b,j as L,t as u,g as E}from"./index-b2OWAZnp.js";import{L as I}from"./Location24Regular-DGQcAQAS.js";import{C as H}from"./CalendarToday24Regular-C2OphPV9.js";import{I as T,_ as j}from"./_plugin-vue_export-helper-DZzl9uFm.js";const q={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},S=P({name:"People24Regular",render:function(v,i){return l(),r("svg",q,i[0]||(i[0]=[e("g",{fill:"none"},[e("path",{d:"M4 13.999L13 14a2 2 0 0 1 1.995 1.85L15 16v1.5C14.999 21 11.284 22 8.5 22c-2.722 0-6.335-.956-6.495-4.27L2 17.5v-1.501c0-1.054.816-1.918 1.85-1.995L4 14zM15.22 14H20c1.054 0 1.918.816 1.994 1.85L22 16v1c-.001 3.062-2.858 4-5 4a7.16 7.16 0 0 1-2.14-.322c.336-.386.607-.827.802-1.327A6.19 6.19 0 0 0 17 19.5l.267-.006c.985-.043 3.086-.363 3.226-2.289L20.5 17v-1a.501.501 0 0 0-.41-.492L20 15.5h-4.051a2.957 2.957 0 0 0-.595-1.34L15.22 14H20h-4.78zM4 15.499l-.1.01a.51.51 0 0 0-.254.136a.506.506 0 0 0-.136.253l-.01.101V17.5c0 1.009.45 1.722 1.417 2.242c.826.445 2.003.714 3.266.753l.317.005l.317-.005c1.263-.039 2.439-.308 3.266-.753c.906-.488 1.359-1.145 1.412-2.057l.005-.186V16a.501.501 0 0 0-.41-.492L13 15.5l-9-.001zM8.5 3a4.5 4.5 0 1 1 0 9a4.5 4.5 0 0 1 0-9zm9 2a3.5 3.5 0 1 1 0 7a3.5 3.5 0 0 1 0-7zm-9-.5c-1.654 0-3 1.346-3 3s1.346 3 3 3s3-1.346 3-3s-1.346-3-3-3zm9 2c-1.103 0-2 .897-2 2s.897 2 2 2s2-.897 2-2s-.897-2-2-2z",fill:"currentColor"})],-1)]))}}),U={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},G=P({name:"Person24Regular",render:function(v,i){return l(),r("svg",U,i[0]||(i[0]=[e("g",{fill:"none"},[e("path",{d:"M17.754 14a2.249 2.249 0 0 1 2.249 2.25v.575c0 .894-.32 1.759-.901 2.438c-1.57 1.833-3.957 2.738-7.102 2.738c-3.146 0-5.532-.905-7.098-2.74a3.75 3.75 0 0 1-.899-2.434v-.578A2.249 2.249 0 0 1 6.253 14h11.501zm0 1.5H6.252a.749.749 0 0 0-.749.75v.577c0 .535.192 1.053.54 1.46c1.253 1.469 3.219 2.214 5.957 2.214s4.706-.745 5.962-2.213a2.25 2.25 0 0 0 .54-1.463v-.576a.749.749 0 0 0-.748-.749zM12 2.005a5 5 0 1 1 0 10a5 5 0 0 1 0-10zm0 1.5a3.5 3.5 0 1 0 0 7a3.5 3.5 0 0 0 0-7z",fill:"currentColor"})],-1)]))}}),J={class:"albums-container"},K={key:0,class:"loading-state"},O={key:0,class:"album-section"},Q={class:"section-header"},W={class:"album-cover"},X={class:"cover-placeholder"},Z={class:"album-info"},ee={key:1,class:"album-section"},oe={class:"section-header"},te={class:"album-cover person-cover"},ne={class:"cover-placeholder"},ae={class:"album-info"},se={key:2,class:"album-section"},le={class:"section-header"},ce={class:"album-cover year-cover"},re={class:"cover-placeholder"},ie={class:"year-text"},ue={class:"album-info"},pe={key:3,class:"empty-state"},de=P({__name:"AlbumsView",setup(M){const v=E(),i=N(),y=C(!0),_=C([]),m=C([]),g=C([]),V=()=>!!window.photoAPI,B=()=>{_.value=[{id:"place-日本东京",name:"日本东京",photoCount:245,type:"place"},{id:"place-新疆",name:"新疆",photoCount:189,type:"place"},{id:"place-北京",name:"北京",photoCount:156,type:"place"}],m.value=[{id:1,name:"爸爸",photoCount:156,type:"person"},{id:2,name:"妈妈",photoCount:142,type:"person"},{id:3,name:"儿子",photoCount:89,type:"person"},{id:4,name:"我",photoCount:234,type:"person"}];const o=new Date().getFullYear();g.value=[{id:`year-${o-1}`,name:`${o-1}年`,year:o-1,photoCount:456,type:"year"},{id:`year-${o-2}`,name:`${o-2}年`,year:o-2,photoCount:389,type:"year"},{id:`year-${o-3}`,name:`${o-3}年`,year:o-3,photoCount:412,type:"year"}]},D=async()=>{if(y.value=!0,!V()){await new Promise(o=>setTimeout(o,500)),B(),y.value=!1;return}try{const o=await window.photoAPI.places.getAll();_.value=(o||[]).map(n=>({id:`place-${n.place_name}`,name:n.place_name,photoCount:n.photo_count,type:"place"}));const c=await window.photoAPI.people.getAll();m.value=(c||[]).map(n=>({id:n.id,name:n.name,photoCount:n.face_count,type:"person"}));const h=new Date().getFullYear();g.value=[h-1,h-2,h-3].map(n=>({id:`year-${n}`,name:`${n}年`,year:n,photoCount:0,type:"year"}))}catch(o){console.error("加载相册失败:",o),i.error("加载相册失败")}finally{y.value=!1}},k=o=>{o.type==="year"?v.push(`/timeline/${o.year}`):v.push(`/search?type=${o.type}&q=${encodeURIComponent(o.name)}`)};return Y(()=>{D()}),(o,c)=>{const h=p("n-spin"),n=p("n-icon"),x=p("n-card"),A=p("n-gi"),$=p("n-grid"),F=p("n-empty");return l(),r("div",J,[c[5]||(c[5]=e("header",{class:"header"},[e("h1",null,"智能相册"),e("p",{class:"subtitle"},"按人物、地点自动整理")],-1)),y.value?(l(),r("div",K,[t(h,{size:"large"}),c[0]||(c[0]=e("p",null,"加载中...",-1))])):(l(),r(f,{key:1},[_.value.length>0?(l(),r("section",O,[e("div",Q,[e("h2",null,[t(n,null,{default:a(()=>[t(d(I))]),_:1}),c[1]||(c[1]=z(" 按地点 ",-1))])]),t($,{cols:3,"x-gap":16,"y-gap":16},{default:a(()=>[(l(!0),r(f,null,b(_.value,s=>(l(),L(A,{key:s.id},{default:a(()=>[t(x,{class:"album-card",hoverable:"",onClick:R=>k(s)},{default:a(()=>[e("div",W,[e("div",X,[t(n,{size:"48",color:"#5E6AD2"},{default:a(()=>[t(d(I))]),_:1})])]),e("div",Z,[e("h3",null,u(s.name),1),e("p",null,u(s.photoCount)+" 张照片",1)])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})])):w("",!0),m.value.length>0?(l(),r("section",ee,[e("div",oe,[e("h2",null,[t(n,null,{default:a(()=>[t(d(S))]),_:1}),c[2]||(c[2]=z(" 按人物 ",-1))])]),t($,{cols:4,"x-gap":16,"y-gap":16},{default:a(()=>[(l(!0),r(f,null,b(m.value,s=>(l(),L(A,{key:s.id},{default:a(()=>[t(x,{class:"album-card",hoverable:"",onClick:R=>k(s)},{default:a(()=>[e("div",te,[e("div",ne,[t(n,{size:"48",color:"#5E6AD2"},{default:a(()=>[t(d(G))]),_:1})])]),e("div",ae,[e("h3",null,u(s.name),1),e("p",null,u(s.photoCount)+" 张照片",1)])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})])):w("",!0),g.value.length>0?(l(),r("section",se,[e("div",le,[e("h2",null,[t(n,null,{default:a(()=>[t(d(H))]),_:1}),c[3]||(c[3]=z(" 历年回忆 ",-1))])]),t($,{cols:3,"x-gap":16,"y-gap":16},{default:a(()=>[(l(!0),r(f,null,b(g.value,s=>(l(),L(A,{key:s.id},{default:a(()=>[t(x,{class:"album-card",hoverable:"",onClick:R=>k(s)},{default:a(()=>[e("div",ce,[e("div",re,[e("span",ie,u(s.year),1)])]),e("div",ue,[e("h3",null,u(s.name),1),e("p",null,u(s.photoCount)+" 张照片",1)])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})])):w("",!0),_.value.length===0&&m.value.length===0?(l(),r("div",pe,[t(F,{description:"暂无智能相册"},{icon:a(()=>[t(n,{size:"64",color:"#ccc"},{default:a(()=>[t(d(T))]),_:1})]),extra:a(()=>[...c[4]||(c[4]=[e("p",null,"同步照片后自动生成智能相册",-1)])]),_:1})])):w("",!0)],64))])}}}),ye=j(de,[["__scopeId","data-v-72bd9d69"]]);export{ye as default};
