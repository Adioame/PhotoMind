import{d as N,o as l,c,a as o,u as F,b as E,t as _,e,w as a,j as z,F as U,l as Y,k as b,r as m,f as v,h as L,i as y,g as Z}from"./index-b2OWAZnp.js";import{P as q}from"./PhotoGrid-CbLsguGP.js";import{L as J}from"./Location24Regular-DGQcAQAS.js";import{_ as K}from"./_plugin-vue_export-helper-DZzl9uFm.js";const O={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Q=N({name:"Grid24Regular",render:function(P,r){return l(),c("svg",O,r[0]||(r[0]=[o("g",{fill:"none"},[o("path",{d:"M8.75 13A2.25 2.25 0 0 1 11 15.25v3.5A2.25 2.25 0 0 1 8.75 21h-3.5A2.25 2.25 0 0 1 3 18.75v-3.5A2.25 2.25 0 0 1 5.25 13h3.5zm10 0A2.25 2.25 0 0 1 21 15.25v3.5A2.25 2.25 0 0 1 18.75 21h-3.5A2.25 2.25 0 0 1 13 18.75v-3.5A2.25 2.25 0 0 1 15.25 13h3.5zm-10 1.5h-3.5a.75.75 0 0 0-.75.75v3.5c0 .414.336.75.75.75h3.5a.75.75 0 0 0 .75-.75v-3.5a.75.75 0 0 0-.75-.75zm10 0h-3.5a.75.75 0 0 0-.75.75v3.5c0 .414.336.75.75.75h3.5a.75.75 0 0 0 .75-.75v-3.5a.75.75 0 0 0-.75-.75zM8.75 3A2.25 2.25 0 0 1 11 5.25v3.5A2.25 2.25 0 0 1 8.75 11h-3.5A2.25 2.25 0 0 1 3 8.75v-3.5A2.25 2.25 0 0 1 5.25 3h3.5zm10 0A2.25 2.25 0 0 1 21 5.25v3.5A2.25 2.25 0 0 1 18.75 11h-3.5A2.25 2.25 0 0 1 13 8.75v-3.5A2.25 2.25 0 0 1 15.25 3h3.5zm-10 1.5h-3.5a.75.75 0 0 0-.75.75v3.5c0 .414.336.75.75.75h3.5a.75.75 0 0 0 .75-.75v-3.5a.75.75 0 0 0-.75-.75zm10 0h-3.5a.75.75 0 0 0-.75.75v3.5c0 .414.336.75.75.75h3.5a.75.75 0 0 0 .75-.75v-3.5a.75.75 0 0 0-.75-.75z",fill:"currentColor"})],-1)]))}}),W={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},X=N({name:"List24Regular",render:function(P,r){return l(),c("svg",W,r[0]||(r[0]=[o("g",{fill:"none"},[o("path",{d:"M2.75 18h12.5a.75.75 0 0 1 .102 1.493l-.102.007H2.75a.75.75 0 0 1-.102-1.494L2.75 18h12.5h-12.5zm0-6.5h18.5a.75.75 0 0 1 .102 1.493L21.25 13H2.75a.75.75 0 0 1-.102-1.493l.102-.007h18.5h-18.5zm0-6.497h15.5a.75.75 0 0 1 .102 1.493l-.102.007H2.75a.75.75 0 0 1-.102-1.493l.102-.007h15.5h-15.5z",fill:"currentColor"})],-1)]))}}),tt={class:"photos-container"},et={class:"header"},ot={class:"header-left"},nt={class:"subtitle"},at={class:"header-right"},lt={key:1,class:"photo-list"},st={key:0,class:"loading-state"},it=["onClick"],rt={class:"list-thumb"},ut={class:"list-info"},ct={key:0,class:"location"},dt={key:2,class:"load-more"},vt={key:0,class:"photo-preview"},ht={class:"preview-image"},mt={class:"preview-info"},g=24,_t=N({__name:"PhotosView",setup(B){Z();const P=F(),r=m(!0),f=m("grid"),n=m([]),$=m(0),S=m(!0),w=m(0),C=m(!1),u=m(null),I=()=>!!window.photoAPI,j=(s,t=0)=>{const h=[{name:"日本东京",lat:35.6762,lng:139.6503},{name:"新疆乌鲁木齐",lat:43.8256,lng:87.6168},{name:"北京",lat:39.9042,lng:116.4074},{name:"上海",lat:31.2304,lng:121.4737},{name:"家里",lat:39.9042,lng:116.4074}];return Array.from({length:s},(x,M)=>{const d=t+M,k=2015+Math.floor(d/100),A=d%12+1,p=d%28+1;return{id:d,uuid:`photo-${d}`,fileName:`IMG_${k}${String(A).padStart(2,"0")}${String(p).padStart(2,"0")}_${d}.jpg`,takenAt:`${k}-${String(A).padStart(2,"0")}-${String(p).padStart(2,"0")}T10:30:00Z`,location:h[d%h.length]}})},R=async(s=!1)=>{s&&(r.value=!0);try{if(I()){const t=await window.photoAPI.photos.getList({limit:g,offset:w.value});s?n.value=[...n.value,...t||[]]:n.value=t||[]}else{await new Promise(h=>setTimeout(h,300));const t=j(g,w.value);s?n.value=[...n.value,...t]:n.value=t,$.value=100,S.value=w.value+g<100}if(I()){const t=await window.photoAPI.photos.getList({limit:g,offset:w.value});s?n.value=[...n.value,...t||[]]:n.value=t||[],$.value=n.value.length,S.value=t?.length===g}w.value+=g}catch(t){console.error("加载照片失败:",t),P.error("加载照片失败")}finally{r.value=!1}},G=()=>{R(!0)},V=s=>{u.value=s,C.value=!0},D=s=>{if(!s)return"-";const t=new Date(s);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`};return E(()=>{R()}),(s,t)=>{const h=v("n-icon"),x=v("n-button"),M=v("n-button-group"),d=v("n-spin"),k=v("n-image"),A=v("n-empty"),p=v("n-descriptions-item"),H=v("n-descriptions"),T=v("n-modal");return l(),c("div",tt,[o("header",et,[o("div",ot,[t[3]||(t[3]=o("h1",null,"照片",-1)),o("p",nt,_($.value)+" 张照片",1)]),o("div",at,[e(M,null,{default:a(()=>[e(x,{type:f.value==="grid"?"primary":"default",onClick:t[0]||(t[0]=i=>f.value="grid")},{icon:a(()=>[e(h,null,{default:a(()=>[e(L(Q))]),_:1})]),_:1},8,["type"]),e(x,{type:f.value==="list"?"primary":"default",onClick:t[1]||(t[1]=i=>f.value="list")},{icon:a(()=>[e(h,null,{default:a(()=>[e(L(X))]),_:1})]),_:1},8,["type"])]),_:1})])]),f.value==="grid"?(l(),z(q,{key:0,photos:n.value,loading:r.value,columns:4,onPhotoClick:V},null,8,["photos","loading"])):(l(),c("div",lt,[r.value?(l(),c("div",st,[e(d,{size:"large"})])):n.value.length>0?(l(!0),c(U,{key:1},Y(n.value,i=>(l(),c("div",{key:i.id,class:"list-item",onClick:pt=>V(i)},[o("div",rt,[e(k,{src:i.thumbnailPath||i.thumbnail_url,"object-fit":"cover",style:{width:"80px",height:"80px"}},null,8,["src"])]),o("div",ut,[o("h3",null,_(i.fileName),1),o("p",null,_(D(i.takenAt)),1),i.location?.name?(l(),c("p",ct,[e(h,null,{default:a(()=>[e(L(J))]),_:1}),y(" "+_(i.location.name),1)])):b("",!0)])],8,it))),128)):(l(),z(A,{key:2,description:"暂无照片"}))])),S.value&&!r.value?(l(),c("div",dt,[e(x,{onClick:G},{default:a(()=>[...t[4]||(t[4]=[y("加载更多",-1)])]),_:1})])):b("",!0),e(T,{show:C.value,"onUpdate:show":t[2]||(t[2]=i=>C.value=i),preset:"card",style:{width:"90%","max-width":"900px"}},{header:a(()=>[...t[5]||(t[5]=[o("span",null,"照片详情",-1)])]),default:a(()=>[u.value?(l(),c("div",vt,[o("div",ht,[e(k,{src:u.value.thumbnailPath||u.value.thumbnail_url,"preview-src":u.value.thumbnailPath||u.value.thumbnail_url,"object-fit":"contain",style:{width:"100%","max-height":"500px"}},null,8,["src","preview-src"])]),o("div",mt,[e(H,{column:1,"label-placement":"left"},{default:a(()=>[e(p,{label:"文件名"},{default:a(()=>[y(_(u.value.fileName),1)]),_:1}),e(p,{label:"拍摄时间"},{default:a(()=>[y(_(D(u.value.takenAt)),1)]),_:1}),u.value.location?.name?(l(),z(p,{key:0,label:"地点"},{default:a(()=>[y(_(u.value.location.name),1)]),_:1})):b("",!0)]),_:1})])])):b("",!0)]),_:1},8,["show"])])}}}),yt=K(_t,[["__scopeId","data-v-26b856d8"]]);export{yt as default};
